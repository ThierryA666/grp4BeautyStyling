<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DM2 Tests QUnit</title>
    <link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.20.0.css">
</head>
<body>
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>


    <script src="https://code.jquery.com/qunit/qunit-2.20.0.js"></script>  
    <script>

    function controlForm(input){
        let retour = {
            code    : 0,
            message : ""
        } 

        if (!input) {retour.code=1; retour.message = "Champs obligatoire"}

        else if (typeof(Number(input)=="number") || !input.match(/.+@.+\..+/)) {retour.code=2; retour.message = "Veuillez saisir votre adresse mail dans le bon format"}

        return retour;
    }  

    function controlNumber(input){
        let retour = {
            code    : 0,
            message : ""
        }    
        if (input.length<10 || input.length>11){retour.code=3; retour.message = "Saisissez votre numéro de téléphone à 10 chiffres."};
        return retour;
    }

    function controlPW(input){    
  
        let retour = {
            code    : 0,
            message : ""
        }    
        if (typeof(Number(input)) == "number" || !input.match(/^([a-zA-Z0-9]{8,})$/)){retour.code=4; retour.message = "Veuillez saisir un mot de passe d'au moins 8 caractères."}
        return retour;
    }

    function controlZip(list){
       if (list.length==0) {throw new Error('Il y a une erreur de saisie sur code postale.');} 
       return retour;
    }

    //code 1: "Champs obligatoire"
    //code 2: "Veuillez saisir votre adresse mail dans le bon format"
    //code 3: "Saisissez votre numéro de téléphone à 10 chiffres"
    //code 4: "Veuillez saisir un mot de passe d'au moins 8 caractères."
    //code 5: "Le mot de passe saisi ne correspond pas au mot de passe de confirmation."
    //code 6: throw new Error ('Il y a une erreur de saisie sur code postale.')
    
    const {test} = QUnit;
    test('T1- champ vide', assert => {
        const reponse = controlForm("");
        assert.equal(reponse.code,1);
        assert.equal(reponse.message,"Champs obligatoire");
    });

    test('T2- format email', assert => {
        const reponse = controlForm("abc");
        assert.equal(reponse.code,2);
        assert.equal(reponse.message,"Veuillez saisir votre adresse mail dans le bon format");
    });

    test('T3- chiffres numero de tel', assert => {
        const reponse = controlNumber("067619213");
        assert.equal(reponse.code,3);
        assert.equal(reponse.message,"Saisissez votre numéro de téléphone à 10 chiffres.");
    });
   
    test('T4- controle pw', assert =>{
        const reponse = controlPW("12345");
        assert.equal(reponse.code,4);
        assert.equal(reponse.message,"Veuillez saisir un mot de passe d'au moins 8 caractères.");
    })

    test('T5- controle code postale', assert =>{
        let listCom =[]
        
        assert.throws(function(){
            controlZip(listCom)
        })
    })
   </script>
</body>
</html>